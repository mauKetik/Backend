require('dotenv').config()
const app = require('../app')
const PORT = process.env.PORT || 3000;


const http = require('http')
const socketIo = require('socket.io')

const server = http.createServer(app)


const io = socketIo(server, {
    cors: {
        origin: "*"
      }
})

io.on('connection', (socket) => {
    console.log(`io connected!`);
    socket.on('userJoin', (guestUser) => {
        socket.broadcast.emit('userJoin', guestUser)
    })
    socket.on('createRoom', (createdRoom) => {
        socket.broadcast.emit('createRoom', createdRoom)
    })
    socket.on('typingValue', (typingVal) => {
        socket.broadcast.emit('typingValue', typingVal)
    })
    socket.on('userLeave', (leavedUser) => {
        socket.broadcast.emit('userLeave', leavedUser)
    })

})

server.listen(PORT, () => {
    console.log(`Listening on ${PORT}`);
})