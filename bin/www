require('dotenv').config()
const app = require('../app')
const PORT = process.env.PORT || 3000;


const http = require('http')
const socketIo = require('socket.io')

const server = http.createServer(app)


const io = socketIo(server, {
    cors: {
        origin: "*"
      }
})

io.on('connection', (socket) => {
    console.log(`io connected!`);
    socket.on('userJoin', (guestUser) => {
        socket.broadcast.emit('userJoin', guestUser)
    })
    socket.on('createRoom', (createdRoom) => {
 
        console.log(createdRoom, 'masuk room');
        socket.broadcast.emit('createRoom', createdRoom)
    })
    socket.on('typingValue', (typingVal) => {

        console.log(typingVal, 'masukVal');
        socket.broadcast.emit('typingValue', typingVal)
    })

})

server.listen(PORT, () => {
    console.log(`Listening on ${PORT}`);
})